(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[363],{20344:(e,s,t)=>{"use strict";t.d(s,{Xq:()=>l,ut:()=>n});var a=t(12115),i=t(52236);function r(e){let[s,t]=(0,a.useState)({data:null,loading:!1,error:null}),i=(0,a.useRef)(e);(0,a.useEffect)(()=>{i.current=e},[e]);let r=(0,a.useCallback)(async function(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];t(e=>({...e,loading:!0,error:null}));try{let e=await i.current(...s);e.success?t({data:e.data,loading:!1,error:null}):t({data:null,loading:!1,error:e.error||"Unknown error occurred"})}catch(e){t({data:null,loading:!1,error:e instanceof Error?e.message:"Unknown error occurred"})}},[]),n=(0,a.useCallback)(()=>{t({data:null,loading:!1,error:null})},[]);return{...s,execute:r,reset:n}}function n(){return r(i.K.checkHealth.bind(i.K))}function l(){return r(e=>i.K.analyzeDCF(e))}},47382:(e,s,t)=>{Promise.resolve().then(t.bind(t,51652))},51652:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>J});var a=t(95155),i=t(12115),r=t(86948),n=t(3998),l=t(11647),c=t(5917),d=t(52987),o=function(e){return e.NOT_NEEDED="not_needed",e.PLANNED="planned",e.IN_PROGRESS="in_progress",e.COMPLETED="completed",e}({});let u=[{id:"multifamily-residential",name:"Multifamily Residential",description:"Apartment buildings, condos, and residential complexes",icon:"\uD83C\uDFE2",category:"residential",defaultConfig:{residential_units:{total_units:12,average_rent_per_unit:2500,average_square_feet_per_unit:850},renovation_info:{status:o.PLANNED,anticipated_duration_months:6,estimated_cost:15e4},equity_structure:{investor_equity_share_pct:25,self_cash_percentage:80}},formConfig:{showCommercialUnits:!1,showResidentialUnits:!0,requiredFields:["property_name","residential_units","renovation_info","equity_structure"],optionalFields:["commercial_units","purchase_price","property_address","notes"]}},{id:"single-family-residential",name:"Single Family Residential",description:"Single family homes, townhouses, and duplexes",icon:"\uD83C\uDFE0",category:"single-family",defaultConfig:{residential_units:{total_units:1,average_rent_per_unit:3200,average_square_feet_per_unit:1800},renovation_info:{status:o.PLANNED,anticipated_duration_months:3,estimated_cost:75e3},equity_structure:{investor_equity_share_pct:20,self_cash_percentage:75}},formConfig:{showCommercialUnits:!1,showResidentialUnits:!0,requiredFields:["property_name","residential_units","renovation_info","equity_structure"],optionalFields:["commercial_units","purchase_price","property_address","notes"]}},{id:"mixed-use",name:"Mixed-Use Property",description:"Residential units with ground-floor commercial space",icon:"\uD83C\uDFEC",category:"mixed-use",defaultConfig:{residential_units:{total_units:8,average_rent_per_unit:2200,average_square_feet_per_unit:750},commercial_units:{total_units:3,average_rent_per_unit:22400,average_square_feet_per_unit:800},renovation_info:{status:o.PLANNED,anticipated_duration_months:8,estimated_cost:18e4},equity_structure:{investor_equity_share_pct:25,self_cash_percentage:85}},formConfig:{showCommercialUnits:!0,showResidentialUnits:!0,requiredFields:["property_name","residential_units","commercial_units","renovation_info","equity_structure"],optionalFields:["purchase_price","property_address","notes"]}}];function m(e){let{selectedTemplate:s,onTemplateSelect:t,onContinue:o}=e,[m,x]=(0,i.useState)(null);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Choose Property Type"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Select a template to get started with optimized default values for your property type"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:u.map(e=>{let i=(null==s?void 0:s.id)===e.id,n=m===e.id;return(0,a.jsxs)(r.Zp,{className:"cursor-pointer transition-all duration-200 ".concat(i?"ring-2 ring-blue-500 border-blue-300 shadow-lg":n?"border-gray-300 shadow-md transform scale-[1.02]":"border-gray-200 hover:border-gray-300"),onClick:()=>t(e),onMouseEnter:()=>x(e.id),onMouseLeave:()=>x(null),children:[(0,a.jsx)(r.aR,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"text-3xl",children:e.icon}),(0,a.jsxs)("div",{children:[(0,a.jsx)(r.ZB,{className:"text-lg",children:e.name}),(0,a.jsx)(l.E,{variant:"outline",className:"mt-1 ".concat((e=>{switch(e){case"residential":return"bg-blue-50 border-blue-200 text-blue-800";case"mixed-use":return"bg-purple-50 border-purple-200 text-purple-800";case"single-family":return"bg-green-50 border-green-200 text-green-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}})(e.category)),children:e.category.replace("-"," ")})]})]}),i&&(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center",children:(0,a.jsx)(c.A,{className:"w-4 h-4 text-white"})})})]})}),(0,a.jsxs)(r.Wu,{children:[(0,a.jsx)(r.BT,{className:"text-sm mb-4",children:e.description}),(0,a.jsxs)("div",{className:"space-y-2 text-xs",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Renovation Period:"}),(0,a.jsxs)("span",{className:"font-medium",children:[e.defaultConfig.renovation_info.anticipated_duration_months," months"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Renovation Budget:"}),(0,a.jsxs)("span",{className:"font-medium",children:["$",e.defaultConfig.renovation_info.estimated_cost.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Equity Percentage:"}),(0,a.jsxs)("span",{className:"font-medium",children:[e.defaultConfig.equity_structure.investor_equity_share_pct,"%"]})]}),e.defaultConfig.residential_units&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Avg. Rent/Unit:"}),(0,a.jsxs)("span",{className:"font-medium",children:["$",e.defaultConfig.residential_units.average_rent_per_unit.toLocaleString()]})]}),e.defaultConfig.commercial_units&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Avg. Rent/Unit:"}),(0,a.jsxs)("span",{className:"font-medium",children:["$",e.defaultConfig.commercial_units.average_rent_per_unit.toLocaleString()]})]})]})]})]},e.id)})}),s&&(0,a.jsx)("div",{className:"flex justify-center pt-6",children:(0,a.jsxs)(n.$,{onClick:o,size:"lg",className:"flex items-center space-x-2",children:[(0,a.jsxs)("span",{children:["Continue with ",s.name]}),(0,a.jsx)(d.A,{className:"w-4 h-4"})]})}),(0,a.jsxs)("div",{className:"text-center pt-4 border-t border-gray-200",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"Don't see your property type?"}),(0,a.jsx)(n.$,{variant:"outline",onClick:()=>{t(u[0])},children:"Start with Custom Template"})]})]})}var x=t(65142),p=t(76444),_=t(14915);let h=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,a.jsx)("textarea",{className:(0,_.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...i})});h.displayName="Textarea";var v=t(80991),g=t(19408),j=t(91761),f=t(15870),y=t(89715),N=t(35626),b=t(44984),w=t(35299),q=t(42529),C=t(6132),S=t(21873),A=t(86651),R=t(65229),k=t(52236);function E(e){let{initialAddress:s,onAddressChange:t,onValidationChange:c,className:d=""}=e,[o,u]=(0,i.useState)({street:(null==s?void 0:s.street)||"",city:(null==s?void 0:s.city)||"",state:(null==s?void 0:s.state)||"",zip_code:(null==s?void 0:s.zip_code)||""}),[m,h]=(0,i.useState)(null),[v,g]=(0,i.useState)(!1),[j,f]=(0,i.useState)(!1),[y,N]=(0,i.useState)(!1),b=k.K.getSupportedMSAs(),E=(0,i.useCallback)(async e=>{if(!e.street.trim()||!e.city.trim()||!e.state.trim()){h(null),c(!1);return}g(!0);try{let r=await k.K.validateAddress(e);if(r.success&&r.data){var s,a,i;let n={is_valid:r.data.isValid,formatted_address:"".concat(e.street,", ").concat(e.city,", ").concat(e.state," ").concat(e.zip_code),msa_code:null==(s=r.data.msa_info)?void 0:s.msa_code,msa_name:null==(a=r.data.msa_info)?void 0:a.name,suggestions:null==(i=r.data.suggestions)?void 0:i.map(e=>"".concat(e.street,", ").concat(e.city,", ").concat(e.state," ").concat(e.zip_code))};h(n),c(n.is_valid),n.is_valid&&t({...e,msa_code:n.msa_code,msa_name:n.msa_name})}else F(e)}catch(s){F(e)}finally{g(!1)}},[t,c]),P=(0,i.useMemo)(()=>(0,_.sg)(E,500),[E]),F=e=>{let s=k.K.getMSAFromCity(e.city,e.state),a=b.find(e=>e.code===s);if(a)h({is_valid:!0,formatted_address:"".concat(e.street,", ").concat(e.city,", ").concat(e.state," ").concat(e.zip_code),msa_code:a.code,msa_name:a.name}),c(!0),t({...e,msa_code:a.code,msa_name:a.name});else{let s=b.filter(s=>s.city.toLowerCase().includes(e.city.toLowerCase())||e.city.toLowerCase().includes(s.city.toLowerCase())).map(e=>"".concat(e.city,", ").concat(e.state)).slice(0,3);h({is_valid:!1,error_message:s.length>0?"City not in supported markets. Did you mean one of these?":"City not in supported markets: ".concat(b.map(e=>"".concat(e.city,", ").concat(e.state)).join(", ")),suggestions:s}),c(!1),f(s.length>0)}},D=(e,s)=>{let t={...o,[e]:s};u(t),N(!0),m&&!m.is_valid&&(h(null),f(!1)),P(t)},U=()=>v?"validating":y&&m?m.is_valid?"valid":"invalid":"neutral";return(0,i.useEffect)(()=>{if(s){let e={street:s.street||"",city:s.city||"",state:s.state||"",zip_code:s.zip_code||""};u(e),e.city&&e.state&&P(e)}},[s,P]),(0,a.jsxs)("div",{className:"space-y-4 ".concat(d),children:[(0,a.jsx)(r.Zp,{className:"".concat((()=>{switch(U()){case"validating":return"border-blue-300 bg-blue-50";case"valid":return"border-green-300 bg-green-50";case"invalid":return"border-red-300 bg-red-50";default:return"border-gray-200"}})()," transition-colors duration-200"),children:(0,a.jsxs)(r.Wu,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(()=>{switch(U()){case"validating":return(0,a.jsx)(w.A,{className:"h-4 w-4 animate-spin text-blue-500"});case"valid":return(0,a.jsx)(q.A,{className:"h-4 w-4 text-green-500"});case"invalid":return(0,a.jsx)(C.A,{className:"h-4 w-4 text-red-500"});default:return(0,a.jsx)(S.A,{className:"h-4 w-4 text-gray-400"})}})(),(0,a.jsx)(p.J,{className:"text-sm font-medium",children:"Property Address"}),(null==m?void 0:m.is_valid)&&m.msa_name&&(0,a.jsx)(l.E,{variant:"secondary",className:"text-xs",children:m.msa_name})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(p.J,{htmlFor:"street",className:"text-sm text-gray-600",children:"Street Address"}),(0,a.jsx)(x.p,{id:"street",value:o.street,onChange:e=>D("street",e.target.value),placeholder:"123 Main Street",className:"mt-1"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(p.J,{htmlFor:"city",className:"text-sm text-gray-600",children:"City"}),(0,a.jsx)(x.p,{id:"city",value:o.city,onChange:e=>D("city",e.target.value),placeholder:"New York",className:"mt-1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(p.J,{htmlFor:"state",className:"text-sm text-gray-600",children:"State"}),(0,a.jsx)(x.p,{id:"state",value:o.state,onChange:e=>D("state",e.target.value.toUpperCase()),placeholder:"NY",maxLength:2,className:"mt-1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(p.J,{htmlFor:"zip",className:"text-sm text-gray-600",children:"ZIP Code"}),(0,a.jsx)(x.p,{id:"zip",value:o.zip_code,onChange:e=>D("zip_code",e.target.value),placeholder:"10001",className:"mt-1"})]})]})]}),m&&(0,a.jsx)("div",{className:"mt-3 text-sm",children:m.is_valid?(0,a.jsxs)("div",{className:"flex items-center gap-2 text-green-700",children:[(0,a.jsx)(q.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:["Address validated • Market: ",m.msa_name]})]}):(0,a.jsx)("div",{className:"text-red-700",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(C.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:m.error_message})]})})})]})}),j&&(null==m?void 0:m.suggestions)&&m.suggestions.length>0&&(0,a.jsx)(r.Zp,{className:"border-blue-200 bg-blue-50",children:(0,a.jsxs)(r.Wu,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(A.A,{className:"h-4 w-4 text-blue-600"}),(0,a.jsx)(p.J,{className:"text-sm font-medium text-blue-800",children:"Suggested Locations"})]}),(0,a.jsx)(n.$,{variant:"ghost",size:"sm",onClick:()=>f(!1),className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-800",children:(0,a.jsx)(R.A,{className:"h-4 w-4"})})]}),(0,a.jsx)("div",{className:"space-y-2",children:m.suggestions.map((e,s)=>(0,a.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>(e=>{let[s,t]=e.split(", "),a={...o,city:s.trim(),state:t.trim()};u(a),f(!1),P(a)})(e),className:"w-full justify-start text-left border-blue-200 hover:bg-blue-100",children:[(0,a.jsx)(S.A,{className:"h-3 w-3 mr-2"}),e]},s))})]})}),!(null==m?void 0:m.is_valid)&&y&&(0,a.jsx)(r.Zp,{className:"border-gray-200",children:(0,a.jsxs)(r.Wu,{className:"p-4",children:[(0,a.jsx)(p.J,{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Supported Markets"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:b.map(e=>(0,a.jsxs)(l.E,{variant:"outline",className:"text-xs cursor-pointer hover:bg-gray-100",onClick:()=>{u(s=>({...s,city:e.city,state:e.state})),P({...o,city:e.city,state:e.state})},children:[e.city,", ",e.state]},e.code))})]})})]})}let P={cap_rate:.045,interest_rate:.07,vacancy_rate:.05,rent_growth_rate:.035,expense_growth_rate:.025,property_growth_rate:.03,ltv_ratio:.75,closing_cost_pct:.03,lender_reserves_months:3,management_fee_pct:.08,maintenance_reserve_per_unit:600,last_updated:new Date().toISOString()};var F=t(23327),D=t(89559);function U(e){let s,t,{msaCode:i,msaName:c,marketDefaults:d,loading:o,error:u,onApplyDefaults:m,onRefresh:x,className:p=""}=e,h=e=>"".concat((100*e).toFixed(1),"%");return i?(0,a.jsxs)(r.Zp,{className:"".concat(o?"border-blue-300 bg-blue-50":u?"border-red-300 bg-red-50":d?"border-green-300 bg-green-50":"border-gray-200"," transition-colors duration-200 ").concat(p),children:[(0,a.jsx)(r.aR,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[o?(0,a.jsx)(w.A,{className:"h-4 w-4 animate-spin text-blue-500"}):u?(0,a.jsx)(C.A,{className:"h-4 w-4 text-red-500"}):d?(0,a.jsx)(q.A,{className:"h-4 w-4 text-green-500"}):(0,a.jsx)(F.A,{className:"h-4 w-4 text-gray-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)(r.ZB,{className:"text-sm font-medium",children:"Market Defaults"}),c&&(0,a.jsxs)(r.BT,{className:"text-xs",children:[c," • MSA ",i]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[x&&(0,a.jsx)(n.$,{variant:"ghost",size:"sm",onClick:x,disabled:o,className:"h-7 w-7 p-0",children:(0,a.jsx)(D.A,{className:"h-3 w-3 ".concat(o?"animate-spin":"")})}),d&&m&&(0,a.jsx)(n.$,{variant:"outline",size:"sm",onClick:m,className:"text-xs h-7",children:"Apply Defaults"})]})]})}),(0,a.jsxs)(r.Wu,{className:"pt-0",children:[o&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-blue-700 text-sm",children:[(0,a.jsx)(w.A,{className:"h-4 w-4 animate-spin"}),(0,a.jsx)("span",{children:"Loading market data..."})]}),u&&(0,a.jsxs)("div",{className:"text-red-700 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(C.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Unable to load market data"})]}),(0,a.jsx)("p",{className:"text-xs mt-1 text-red-600",children:"Using fallback defaults for this market"})]}),d&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-xs font-medium ".concat(_.qd.secondary," mb-2"),children:"Key Financial Metrics"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:_.qd.muted,children:"Cap Rate:"}),(0,a.jsx)(l.E,{variant:"secondary",className:"text-xs",children:h(d.cap_rate)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:_.qd.muted,children:"Interest Rate:"}),(0,a.jsx)(l.E,{variant:"secondary",className:"text-xs",children:h(d.interest_rate)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:_.qd.muted,children:"Vacancy Rate:"}),(0,a.jsx)(l.E,{variant:"secondary",className:"text-xs",children:h(d.vacancy_rate)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:_.qd.muted,children:"LTV Ratio:"}),(0,a.jsx)(l.E,{variant:"secondary",className:"text-xs",children:h(d.ltv_ratio)})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-xs font-medium ".concat(_.qd.secondary," mb-2"),children:"Annual Growth Rates"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:_.qd.muted,children:"Rent Growth:"}),(0,a.jsx)(l.E,{variant:"outline",className:"text-xs",children:h(d.rent_growth_rate)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:_.qd.muted,children:"Expense Growth:"}),(0,a.jsx)(l.E,{variant:"outline",className:"text-xs",children:h(d.expense_growth_rate)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:_.qd.muted,children:"Property Growth:"}),(0,a.jsx)(l.E,{variant:"outline",className:"text-xs",children:h(d.property_growth_rate)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:_.qd.muted,children:"Management Fee:"}),(0,a.jsx)(l.E,{variant:"outline",className:"text-xs",children:h(d.management_fee_pct)})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-xs font-medium ".concat(_.qd.secondary," mb-2"),children:"Other Parameters"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:_.qd.muted,children:"Closing Costs:"}),(0,a.jsx)(l.E,{variant:"outline",className:"text-xs",children:h(d.closing_cost_pct)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:_.qd.muted,children:"Lender Reserves:"}),(0,a.jsx)(l.E,{variant:"outline",className:"text-xs",children:(s=d.lender_reserves_months,"".concat(s.toFixed(1)," months"))})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:_.qd.muted,children:"Maintenance Reserve:"}),(0,a.jsxs)(l.E,{variant:"outline",className:"text-xs",children:[(t=d.maintenance_reserve_per_unit,"$".concat(t.toLocaleString())),"/unit"]})]})]})]}),m&&(0,a.jsx)("div",{className:"pt-2 border-t border-gray-200",children:(0,a.jsxs)(n.$,{onClick:m,className:"w-full text-xs h-8",variant:"default",size:"sm",children:[(0,a.jsx)(j.A,{className:"h-3 w-3 mr-1"}),"Apply All Market Defaults to Analysis"]})})]})]})]}):(0,a.jsx)(r.Zp,{className:"border-gray-200 ".concat(p),children:(0,a.jsx)(r.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,a.jsx)(F.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm",children:"Select a property address to view market defaults"})]})})})}let z={basic:{title:"Property Details",icon:g.A,step:1},financial:{title:"Financial Information",icon:j.A,step:2},units:{title:"Unit Information",icon:g.A,step:3},renovation:{title:"Renovation & Costs",icon:f.A,step:4},equity:{title:"Equity Structure",icon:j.A,step:5},review:{title:"Review & Submit",icon:y.A,step:6}};function L(e){let{template:s,onBack:t,onSubmit:c}=e,[u,m]=(0,i.useState)("basic"),[_,g]=(0,i.useState)(!1),[j,f]=(0,i.useState)({}),[y,w]=(0,i.useState)(""),q=(0,i.useRef)(null),C=(0,i.useRef)(null),[S,A]=(0,i.useState)({property_id:"prop_".concat(Date.now()),analysis_date:new Date().toISOString().split("T")[0],property_name:"",notes:"",residential_units:s.defaultConfig.residential_units||{total_units:0,average_rent_per_unit:0},commercial_units:s.defaultConfig.commercial_units,renovation_info:s.defaultConfig.renovation_info||{status:o.NOT_NEEDED},equity_structure:s.defaultConfig.equity_structure||{investor_equity_share_pct:0,self_cash_percentage:0}}),{data:R,loading:k}=function(){let[e,s]=(0,i.useState)({loading:!1,data:null,error:null,lastUpdated:null}),[t,a]=(0,i.useState)(null),r=(0,i.useCallback)(async e=>{if(!e)return void s({loading:!1,data:null,error:"MSA code is required",lastUpdated:null});s(e=>({...e,loading:!0,error:null}));try{let t=Date.now();s({loading:!1,data:P,error:null,lastUpdated:new Date(t)}),a(e)}catch(t){s({loading:!1,data:P,error:null,lastUpdated:new Date}),a(e)}},[]),n=(0,i.useCallback)(()=>{t&&r(t)},[t,r]),l=(0,i.useCallback)((s,t)=>{if(e.data){if(t&&t.length>0){let a=Object.keys(e.data).filter(e=>t.includes(e)).reduce((s,t)=>(s[t]=e.data[t],s),{});return{...s,...a}}return{...s,...e.data}}return s},[e.data]),c=(0,i.useCallback)(s=>e.data?e.data[s]:null,[e.data]),d=(0,i.useCallback)(()=>!!e.lastUpdated&&Date.now()-e.lastUpdated.getTime()<18e5,[e.lastUpdated]);return{...e,msaCode:t,fetchDefaults:r,refresh:n,applyDefaults:l,getDefaultValue:c,isDataFresh:d}}(),F=z[u].step,D=e=>{A(s=>({...s,...e}));let s=Object.keys(e);f(e=>{let t={...e};return s.forEach(e=>{delete t[e]}),t})},L=e=>{D({address:{street:e.street,city:e.city,state:e.state,zip_code:e.zip_code,msa_code:e.msa_code}})},I=()=>{R&&D({analysis_parameters:{analysis_period_years:6,...S.analysis_parameters,exit_cap_rate:R.cap_rate}})},J=e=>{var t,a,i,r,n,l,c;let d={};switch(e){case"basic":(null==(t=S.property_name)?void 0:t.trim())||(d.property_name=b.qd.required("Property name")),_||(d.address="Please enter a valid address with supported MSA");break;case"units":s.formConfig.showResidentialUnits&&(!(null==(a=S.residential_units)?void 0:a.total_units)||S.residential_units.total_units<=0)&&(d.residential_units=b.qd.range("Number of residential units",1)),s.formConfig.showCommercialUnits&&(!(null==(i=S.commercial_units)?void 0:i.total_units)||S.commercial_units.total_units<=0)&&(d.commercial_units=b.qd.range("Number of commercial units",1));break;case"renovation":(null==(r=S.renovation_info)?void 0:r.anticipated_duration_months)||(d.renovation_months=b.qd.required("Renovation duration")),((null==(n=S.renovation_info)?void 0:n.estimated_cost)===void 0||S.renovation_info.estimated_cost<0)&&(d.renovation_cost=b.qd.range("Renovation budget",0));break;case"equity":(null==(l=S.equity_structure)?void 0:l.investor_equity_share_pct)||(d.investor_equity=b.qd.required("Investor equity share")),(null==(c=S.equity_structure)?void 0:c.self_cash_percentage)||(d.self_cash=b.qd.required("Self cash percentage"))}return d},M=e=>0===Object.keys(J(e)).length,Z=e=>{let s=["basic","units","renovation","equity","review"],t=s.indexOf(e);return t<s.length-1?s[t+1]:null},O=e=>{let s=["basic","units","renovation","equity","review"],t=s.indexOf(e);return t>0?s[t-1]:null},$=z[u].icon;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"sr-only","aria-live":"polite","aria-atomic":"true",role:"status",children:y}),(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)(n.$,{variant:"outline",size:"sm",onClick:t,children:[(0,a.jsx)(N.A,{className:"w-4 h-4 mr-2"}),"Back to Templates"]}),(0,a.jsxs)(l.E,{variant:"outline",className:"text-sm",children:[s.icon," ",s.name]})]})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)($,{className:"w-5 h-5 text-blue-600"}),(0,a.jsx)("h2",{id:"step-title",className:"text-xl font-bold text-gray-900",children:z[u].title})]}),(0,a.jsxs)("span",{id:"step-description",className:"text-sm text-gray-500",children:["Step ",F," of ",6]})]}),(0,a.jsx)(v.k,{value:F/6*100,className:"w-full"})]}),(0,a.jsx)(r.Zp,{children:(0,a.jsx)(r.Wu,{className:"p-6",children:(0,a.jsx)("div",{ref:q,role:"region","aria-labelledby":"step-title","aria-describedby":"step-description",children:(()=>{var e,t,i,n,l,c,d,m,_,v,f,y,N,w,q,A,P,F,z,J,M,Z,O,$,T,B;switch(u){case"basic":return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(p.J,{htmlFor:"property_name",className:j.property_name?"text-red-700":"",children:"Property Name *"}),(0,a.jsx)(x.p,{ref:C,id:"property_name",value:S.property_name||"",onChange:e=>D({property_name:e.target.value}),placeholder:"e.g., Sunset Apartments",className:"".concat(b.Rg.input," ").concat(j.property_name?"border-red-500 focus:border-red-500 focus:ring-red-500":""),...b.a0.validation.required(!0),...b.a0.validation.invalid(!!j.property_name),...b.a0.validation.describedBy(j.property_name?"property_name-error":void 0)}),j.property_name&&(0,a.jsx)("p",{id:"property_name-error",className:"text-sm text-red-700 mt-1",role:"alert",children:j.property_name})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(p.J,{htmlFor:"purchase_price",children:"Purchase Price"}),(0,a.jsx)(x.p,{id:"purchase_price",type:"number",value:(null==(e=S.financials)?void 0:e.purchase_price)||"",onChange:e=>D({financials:{down_payment_percentage:0,loan_terms:{loan_term_years:30},monthly_rent_per_unit:0,other_monthly_income:0,monthly_operating_expenses:0,annual_property_taxes:0,annual_insurance:0,capex_percentage:0,...S.financials,purchase_price:e.target.value?Number(e.target.value):0}}),placeholder:"2500000",className:b.Rg.input,"aria-label":"Purchase price in dollars","aria-describedby":"purchase-price-help"}),(0,a.jsx)("p",{id:"purchase-price-help",className:"text-xs text-gray-500",children:"Enter the total acquisition cost (optional)"})]})]}),(0,a.jsx)(E,{initialAddress:{street:(null==(t=S.address)?void 0:t.street)||"",city:(null==(i=S.address)?void 0:i.city)||"",state:(null==(n=S.address)?void 0:n.state)||"",zip_code:(null==(l=S.address)?void 0:l.zip_code)||""},onAddressChange:L,onValidationChange:g}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(p.J,{htmlFor:"notes",children:"Notes"}),(0,a.jsx)(h,{id:"notes",value:S.notes||"",onChange:e=>D({notes:e.target.value}),placeholder:"Additional property details or analysis notes...",rows:3})]})]});case"units":return(0,a.jsxs)("div",{className:"space-y-6",children:[s.formConfig.showResidentialUnits&&(0,a.jsxs)(r.Zp,{children:[(0,a.jsxs)(r.aR,{children:[(0,a.jsx)(r.ZB,{className:"text-lg",children:"Residential Units"}),(0,a.jsx)(r.BT,{children:"Information about residential rental units"})]}),(0,a.jsx)(r.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(p.J,{htmlFor:"res_unit_count",children:"Number of Units *"}),(0,a.jsx)(x.p,{id:"res_unit_count",type:"number",value:(null==(c=S.residential_units)?void 0:c.total_units)||"",onChange:e=>{var s,t;return D({residential_units:{...S.residential_units,total_units:Number(e.target.value),average_rent_per_unit:(null==(s=S.residential_units)?void 0:s.average_rent_per_unit)||0,average_square_feet_per_unit:(null==(t=S.residential_units)?void 0:t.average_square_feet_per_unit)||0}})}})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(p.J,{htmlFor:"res_avg_rent",children:"Avg. Rent per Unit"}),(0,a.jsx)(x.p,{id:"res_avg_rent",type:"number",value:(null==(d=S.residential_units)?void 0:d.average_rent_per_unit)||"",onChange:e=>{var s,t;return D({residential_units:{...S.residential_units,total_units:(null==(s=S.residential_units)?void 0:s.total_units)||0,average_rent_per_unit:Number(e.target.value),average_square_feet_per_unit:(null==(t=S.residential_units)?void 0:t.average_square_feet_per_unit)||0}})}})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(p.J,{htmlFor:"res_avg_sqft",children:"Avg. SqFt per Unit"}),(0,a.jsx)(x.p,{id:"res_avg_sqft",type:"number",value:(null==(m=S.residential_units)?void 0:m.average_square_feet_per_unit)||"",onChange:e=>{var s,t;return D({residential_units:{...S.residential_units,total_units:(null==(s=S.residential_units)?void 0:s.total_units)||0,average_rent_per_unit:(null==(t=S.residential_units)?void 0:t.average_rent_per_unit)||0,average_square_feet_per_unit:Number(e.target.value)}})}})]})]})})]}),s.formConfig.showCommercialUnits&&(0,a.jsxs)(r.Zp,{children:[(0,a.jsxs)(r.aR,{children:[(0,a.jsx)(r.ZB,{className:"text-lg",children:"Commercial Units"}),(0,a.jsx)(r.BT,{children:"Information about commercial rental units"})]}),(0,a.jsx)(r.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(p.J,{htmlFor:"com_unit_count",children:"Number of Units *"}),(0,a.jsx)(x.p,{id:"com_unit_count",type:"number",value:(null==(_=S.commercial_units)?void 0:_.total_units)||"",onChange:e=>{var s,t;return D({commercial_units:{...S.commercial_units,total_units:Number(e.target.value),average_rent_per_unit:(null==(s=S.commercial_units)?void 0:s.average_rent_per_unit)||0,average_square_feet_per_unit:(null==(t=S.commercial_units)?void 0:t.average_square_feet_per_unit)||0}})}})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(p.J,{htmlFor:"com_avg_rent",children:"Avg. Rent per Unit"}),(0,a.jsx)(x.p,{id:"com_avg_rent",type:"number",value:(null==(v=S.commercial_units)?void 0:v.average_rent_per_unit)||"",onChange:e=>{var s,t;return D({commercial_units:{...S.commercial_units,total_units:(null==(s=S.commercial_units)?void 0:s.total_units)||0,average_rent_per_unit:Number(e.target.value),average_square_feet_per_unit:(null==(t=S.commercial_units)?void 0:t.average_square_feet_per_unit)||0}})}})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(p.J,{htmlFor:"com_avg_sqft",children:"Avg. SqFt per Unit"}),(0,a.jsx)(x.p,{id:"com_avg_sqft",type:"number",value:(null==(f=S.commercial_units)?void 0:f.average_square_feet_per_unit)||"",onChange:e=>{var s,t;return D({commercial_units:{...S.commercial_units,total_units:(null==(s=S.commercial_units)?void 0:s.total_units)||0,average_rent_per_unit:(null==(t=S.commercial_units)?void 0:t.average_rent_per_unit)||0,average_square_feet_per_unit:Number(e.target.value)}})}})]})]})})]})]});case"renovation":return(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsxs)(r.Zp,{children:[(0,a.jsxs)(r.aR,{children:[(0,a.jsx)(r.ZB,{className:"text-lg",children:"Renovation Information"}),(0,a.jsx)(r.BT,{children:"Timeline and budget for property improvements"})]}),(0,a.jsx)(r.Wu,{className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(p.J,{htmlFor:"renovation_months",children:"Renovation Period (months) *"}),(0,a.jsx)(x.p,{id:"renovation_months",type:"number",value:(null==(y=S.renovation_info)?void 0:y.anticipated_duration_months)||"",onChange:e=>{var s,t;return D({renovation_info:{...S.renovation_info,status:(null==(s=S.renovation_info)?void 0:s.status)||o.PLANNED,anticipated_duration_months:Number(e.target.value),estimated_cost:(null==(t=S.renovation_info)?void 0:t.estimated_cost)||0}})}})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(p.J,{htmlFor:"renovation_budget",children:"Renovation Budget ($) *"}),(0,a.jsx)(x.p,{id:"renovation_budget",type:"number",value:(null==(N=S.renovation_info)?void 0:N.estimated_cost)||"",onChange:e=>{var s,t;return D({renovation_info:{...S.renovation_info,status:(null==(s=S.renovation_info)?void 0:s.status)||o.PLANNED,anticipated_duration_months:(null==(t=S.renovation_info)?void 0:t.anticipated_duration_months)||0,estimated_cost:Number(e.target.value)}})}})]})]})})]})}),(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsx)(U,{msaCode:null==(w=S.address)?void 0:w.msa_code,msaName:(null==(q=S.address)?void 0:q.city)&&(null==(A=S.address)?void 0:A.state)?"".concat(S.address.city,", ").concat(S.address.state):void 0,marketDefaults:R,loading:k,onApplyDefaults:I,onRefresh:()=>{}})})]})});case"equity":return(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)(r.Zp,{children:[(0,a.jsxs)(r.aR,{children:[(0,a.jsx)(r.ZB,{className:"text-lg",children:"Equity Structure"}),(0,a.jsx)(r.BT,{children:"Investment and financing structure for the property"})]}),(0,a.jsx)(r.Wu,{className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(p.J,{htmlFor:"total_equity",children:"Investor Equity Share (%) *"}),(0,a.jsx)(x.p,{id:"total_equity",type:"number",step:"0.1",value:(null==(P=S.equity_structure)?void 0:P.investor_equity_share_pct)||"",onChange:e=>{var s;return D({equity_structure:{...S.equity_structure,investor_equity_share_pct:Number(e.target.value),self_cash_percentage:(null==(s=S.equity_structure)?void 0:s.self_cash_percentage)||0}})}})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(p.J,{htmlFor:"cash_percentage",children:"Self Cash Percentage *"}),(0,a.jsx)(x.p,{id:"cash_percentage",type:"number",step:"0.1",value:(null==(F=S.equity_structure)?void 0:F.self_cash_percentage)||"",onChange:e=>{var s;return D({equity_structure:{...S.equity_structure,investor_equity_share_pct:(null==(s=S.equity_structure)?void 0:s.investor_equity_share_pct)||0,self_cash_percentage:Number(e.target.value)}})}})]})]})})]})});case"review":return(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)(r.Zp,{children:[(0,a.jsxs)(r.aR,{children:[(0,a.jsx)(r.ZB,{className:"text-lg",children:"Review Your Property Information"}),(0,a.jsx)(r.BT,{children:"Please review all details before submitting for analysis"})]}),(0,a.jsx)(r.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Property Details"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Name:"}),(0,a.jsx)("span",{children:S.property_name})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Location:"}),(0,a.jsxs)("span",{children:[null==(z=S.address)?void 0:z.city,", ",null==(J=S.address)?void 0:J.state]})]}),(null==(M=S.financials)?void 0:M.purchase_price)&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Purchase Price:"}),(0,a.jsxs)("span",{children:["$",S.financials.purchase_price.toLocaleString()]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Unit Information"}),(0,a.jsxs)("div",{className:"space-y-1",children:[S.residential_units&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Residential Units:"}),(0,a.jsx)("span",{children:S.residential_units.total_units})]}),S.commercial_units&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Commercial Units:"}),(0,a.jsx)("span",{children:S.commercial_units.total_units})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Renovation"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Duration:"}),(0,a.jsxs)("span",{children:[null==(Z=S.renovation_info)?void 0:Z.anticipated_duration_months," months"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Budget:"}),(0,a.jsxs)("span",{children:["$",null==($=S.renovation_info)||null==(O=$.estimated_cost)?void 0:O.toLocaleString()]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Equity Structure"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Total Equity:"}),(0,a.jsxs)("span",{children:[null==(T=S.equity_structure)?void 0:T.investor_equity_share_pct,"%"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Cash Portion:"}),(0,a.jsxs)("span",{children:[null==(B=S.equity_structure)?void 0:B.self_cash_percentage,"%"]})]})]})]})]})})]})});default:return null}})()})})}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(n.$,{variant:"outline",onClick:()=>{let e=O(u);e&&(m(e),f({}),w(b.gC.announcements.navigation("".concat(z[e].title," step"))))},disabled:"basic"===u,className:b.Rg.button,"aria-label":"Go to previous step: ".concat(O(u)?z[O(u)].title:""),children:[(0,a.jsx)(N.A,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Previous"]}),"review"===u?(0,a.jsx)(n.$,{onClick:()=>{let e=J("equity");if(Object.keys(e).length>0){f(e),w("Please fix the errors before submitting");return}w("Submitting property for DCF analysis..."),c(S)},disabled:!M("equity"),className:b.Rg.button,"aria-label":"Submit property for DCF analysis",children:"Submit for Analysis"}):(0,a.jsxs)(n.$,{onClick:()=>{let e=J(u);if(Object.keys(e).length>0){f(e),w("Please fix the errors below before continuing");return}let s=Z(u);s&&(m(s),f({}),w(b.gC.announcements.navigation("".concat(z[s].title," step"))))},disabled:!M(u),className:b.Rg.button,"aria-label":"Go to next step: ".concat(Z(u)?z[Z(u)].title:""),children:["Next",(0,a.jsx)(d.A,{className:"w-4 h-4 ml-2","aria-hidden":"true"})]})]})]})}var I=t(20344);function J(){let[e,s]=(0,i.useState)("template-selection"),[t,l]=(0,i.useState)(null),[c,d]=(0,i.useState)(null),o=(0,I.Xq)(),u=e=>{l(e)},x=()=>{t&&s("property-form")},p=()=>{s("template-selection")},_=async e=>{var t,a,i,r,n,l,c,o,u,m,x,p,_,h,v;let g=null==(t=e.address)?void 0:t.city,j=null==(a=e.address)?void 0:a.state;if(g&&j&&!(null==(i=e.address)?void 0:i.msa_code)){let s=k.K.getMSAFromCity(g,j);s&&e.address&&(e.address.msa_code=s)}let f={property_id:e.property_id||"prop_".concat(Date.now()),property_name:e.property_name||"Unnamed Property",analysis_date:e.analysis_date||new Date().toISOString().split("T")[0],residential_units:{total_units:(null==(r=e.residential_units)?void 0:r.total_units)||1,average_rent_per_unit:(null==(n=e.residential_units)?void 0:n.average_rent_per_unit)||0,average_square_feet_per_unit:(null==(l=e.residential_units)?void 0:l.average_square_feet_per_unit)||1e3},commercial_units:e.commercial_units?{total_units:e.commercial_units.total_units||0,average_rent_per_unit:e.commercial_units.average_rent_per_unit||0,average_square_feet_per_unit:e.commercial_units.average_square_feet_per_unit||1e3}:void 0,renovation_info:{status:(null==(c=e.renovation_info)?void 0:c.status)||"planned",anticipated_duration_months:(null==(o=e.renovation_info)?void 0:o.anticipated_duration_months)||6,estimated_cost:(null==(u=e.renovation_info)?void 0:u.estimated_cost)||0},equity_structure:{investor_equity_share_pct:(null==(m=e.equity_structure)?void 0:m.investor_equity_share_pct)||25,self_cash_percentage:(null==(x=e.equity_structure)?void 0:x.self_cash_percentage)||75},city:(null==(p=e.address)?void 0:p.city)||"New York",state:(null==(_=e.address)?void 0:_.state)||"NY",msa_code:(null==(h=e.address)?void 0:h.msa_code)||"35620",property_address:e.address?"".concat(e.address.street||"123 Main St",", ").concat(e.address.city||"New York",", ").concat(e.address.state||"NY"," ").concat(e.address.zip_code||"10001"):"123 Main St, New York, NY 10001",purchase_price:(null==(v=e.financials)?void 0:v.purchase_price)||5e5,notes:e.notes||""};d(f);try{let e=JSON.parse(localStorage.getItem("savedProperties")||"[]");e.push({...f,savedAt:new Date().toISOString(),status:"submitted"}),localStorage.setItem("savedProperties",JSON.stringify(e))}catch(e){}s("success")},h=()=>{l(null),d(null),o.reset(),s("template-selection")},v=async()=>{if(c)try{if(await o.execute(c),o.data&&o.data.success&&o.data.data)try{let e=JSON.parse(localStorage.getItem("savedProperties")||"[]"),s=e.findIndex(e=>e.property_id===c.property_id);s>=0&&(e[s].status="analyzed",e[s].analysis_results=o.data.data,e[s].analyzedAt=new Date().toISOString(),localStorage.setItem("savedProperties",JSON.stringify(e)))}catch(e){}}catch(e){}};return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:["template-selection"===e&&(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Add New Property"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Start by selecting a property template, then enter your property details for analysis"})]}),(()=>{switch(e){case"template-selection":return(0,a.jsx)(m,{selectedTemplate:t,onTemplateSelect:u,onContinue:x});case"property-form":return t?(0,a.jsx)(L,{template:t,onBack:p,onSubmit:_}):null;case"success":var s,i,l,d,g,j;return(0,a.jsxs)("div",{className:"max-w-2xl mx-auto text-center space-y-6",children:[(0,a.jsx)("div",{className:"text-6xl",children:"\uD83C\uDF89"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Property Successfully Submitted!"}),(0,a.jsxs)("p",{className:"text-gray-600",children:['Your property "',null==c?void 0:c.property_name,'" has been saved and is ready for analysis.']})]}),(0,a.jsx)(r.Zp,{children:(0,a.jsx)(r.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"text-left space-y-3",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:"What's Next?"}),(0,a.jsxs)("ul",{className:"space-y-2 text-sm text-gray-600",children:[(0,a.jsxs)("li",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"w-6 h-6 bg-blue-100 text-blue-600 rounded-full text-xs flex items-center justify-center mr-3",children:"1"}),"Run DCF Analysis to get NPV and IRR calculations"]}),(0,a.jsxs)("li",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"w-6 h-6 bg-blue-100 text-blue-600 rounded-full text-xs flex items-center justify-center mr-3",children:"2"}),"Execute Monte Carlo simulation for risk assessment"]}),(0,a.jsxs)("li",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"w-6 h-6 bg-blue-100 text-blue-600 rounded-full text-xs flex items-center justify-center mr-3",children:"3"}),"View market data and forecasts for your property location"]})]})]})})}),o.data&&(0,a.jsx)(r.Zp,{className:"border-green-200 bg-green-50",children:(0,a.jsxs)(r.Wu,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-green-900 mb-4",children:"DCF Analysis Results"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-green-600 font-medium",children:"NPV"}),(0,a.jsxs)("p",{className:"text-green-900 text-lg font-bold",children:["$",o.data.npv.toLocaleString()]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-green-600 font-medium",children:"IRR"}),(0,a.jsxs)("p",{className:"text-green-900 text-lg font-bold",children:[(100*o.data.irr).toFixed(1),"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-green-600 font-medium",children:"Equity Multiple"}),(0,a.jsxs)("p",{className:"text-green-900 text-lg font-bold",children:[o.data.equity_multiple.toFixed(2),"x"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-green-600 font-medium",children:"Recommendation"}),(0,a.jsx)("p",{className:"text-green-900 text-lg font-bold",children:o.data.investment_recommendation.replace("_"," ")})]})]})]})}),o.error&&(0,a.jsx)(r.Zp,{className:"border-red-200 bg-red-50",children:(0,a.jsxs)(r.Wu,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-900 mb-2",children:"Analysis Error"}),(0,a.jsx)("p",{className:"text-red-700 text-sm",children:o.error})]})}),o.data&&o.data.success&&(0,a.jsx)(r.Zp,{className:"border-green-200 bg-green-50",children:(0,a.jsx)(r.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"text-green-600",children:"✅"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-green-800 font-medium",children:"DCF Analysis Complete!"}),(0,a.jsxs)("p",{className:"text-green-700 text-sm",children:["NPV: $",null==(l=o.data.data)||null==(i=l.financial_metrics)||null==(s=i.npv)?void 0:s.toLocaleString()," | IRR: ",(100*((null==(g=o.data.data)||null==(d=g.financial_metrics)?void 0:d.irr)||0)).toFixed(1),"% | Recommendation: ",null==(j=o.data.data)?void 0:j.investment_recommendation]})]})]}),(0,a.jsx)(n.$,{variant:"outline",size:"sm",onClick:()=>window.open("/analysis","_blank"),children:"View Details"})]})})}),(0,a.jsxs)("div",{className:"flex space-x-4 justify-center",children:[(0,a.jsx)(n.$,{variant:"outline",onClick:h,children:"Add Another Property"}),(0,a.jsx)(n.$,{onClick:v,disabled:o.loading,className:"bg-blue-600 hover:bg-blue-700",children:o.loading?"Analyzing Property...":"Run DCF Analysis"})]}),o.loading&&(0,a.jsx)(r.Zp,{className:"border-blue-200 bg-blue-50",children:(0,a.jsx)(r.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),(0,a.jsx)("p",{className:"text-blue-800 text-sm",children:"Running comprehensive DCF analysis with Monte Carlo simulation..."})]})})})]});default:return null}})()]})})}},65142:(e,s,t)=>{"use strict";t.d(s,{p:()=>n});var a=t(95155),i=t(12115),r=t(14915);let n=i.forwardRef((e,s)=>{let{className:t,type:i,...n}=e;return(0,a.jsx)("input",{type:i,className:(0,r.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...n})});n.displayName="Input"},76444:(e,s,t)=>{"use strict";t.d(s,{J:()=>d});var a=t(95155),i=t(12115),r=t(10489),n=t(83101),l=t(14915);let c=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,a.jsx)(r.b,{ref:s,className:(0,l.cn)(c(),t),...i})});d.displayName=r.b.displayName},80991:(e,s,t)=>{"use strict";t.d(s,{k:()=>l});var a=t(95155),i=t(12115),r=t(9484),n=t(14915);let l=i.forwardRef((e,s)=>{let{className:t,value:i,...l}=e;return(0,a.jsx)(r.bL,{ref:s,className:(0,n.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...l,children:(0,a.jsx)(r.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(i||0),"%)")}})})});l.displayName=r.bL.displayName}},e=>{e.O(0,[349,38,915,404,441,255,358],()=>e(e.s=47382)),_N_E=e.O()}]);